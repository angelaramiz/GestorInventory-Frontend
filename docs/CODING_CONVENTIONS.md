# Convenciones de C√≥digo - GestorInventory-Frontend

## üìù Convenciones de Nomenclatura

### Archivos y Directorios
- **Archivos JavaScript**: `kebab-case.js` (ej: `product-repository.js`)
- **Archivos HTML**: `kebab-case.html` (ej: `product-list.html`)
- **Archivos CSS**: `kebab-case.css` (ej: `mobile-components.css`)
- **Directorios**: `kebab-case` (ej: `core/services/`)

### C√≥digo JavaScript

#### Clases
```javascript
// ‚úÖ Correcto - PascalCase
class ProductRepository { }
class InventoryService { }
class AuthManager { }

// ‚ùå Incorrecto
class productRepository { }
class inventory_service { }
```

#### Funciones y M√©todos
```javascript
// ‚úÖ Correcto - camelCase
function findProductById(id) { }
async function saveProductToDatabase(product) { }
const calculateTotalPrice = (items) => { };

// ‚ùå Incorrecto
function FindProductById(id) { }
function save_product_to_database(product) { }
```

#### Variables
```javascript
// ‚úÖ Correcto - camelCase
const productList = [];
let currentUser = null;
const isAuthenticated = false;

// ‚ùå Incorrecto
const ProductList = [];
let current_user = null;
const is_authenticated = false;
```

#### Constantes
```javascript
// ‚úÖ Correcto - UPPER_SNAKE_CASE
const DEFAULT_PAGE_SIZE = 20;
const API_BASE_URL = 'https://api.example.com';
const ERROR_MESSAGES = {
  PRODUCT_NOT_FOUND: 'Producto no encontrado',
  INVALID_CREDENTIALS: 'Credenciales inv√°lidas'
};

// ‚ùå Incorrecto
const defaultPageSize = 20;
const ApiBaseUrl = 'https://api.example.com';
```

#### Elementos DOM
```javascript
// ‚úÖ Correcto - kebab-case para IDs y clases
<div id="product-list" class="inventory-card">
<button class="btn-primary" id="save-product-btn">

// ‚ùå Incorrecto
<div id="productList" class="inventoryCard">
<button class="btnPrimary" id="saveProductBtn">
```

## üèóÔ∏è Patrones de C√≥digo

### Importaciones y Exportaciones

#### Estructura de Imports
```javascript
// 1. Imports de librer√≠as externas
import { v4 as uuidv4 } from 'uuid';
import Swal from 'sweetalert2';

// 2. Imports de m√≥dulos del core
import { ProductRepository } from '../core/repositories/product-repository.js';
import { InventoryService } from '../core/services/inventory-service.js';

// 3. Imports de utilidades
import { logger } from '../utils/logger.js';
import { validateProduct } from '../utils/validation.js';

// 4. Imports de UI
import { showMessage } from '../ui/components/message.js';
```

#### Estructura de Exports
```javascript
// Exports nombrados al final del archivo
export {
  ProductRepository,
  findProductById,
  saveProduct,
  deleteProduct
};

// Export por defecto para la clase principal
export default ProductRepository;
```

### Manejo de Errores
```javascript
// ‚úÖ Correcto - Manejo completo de errores
async function saveProduct(product) {
  try {
    const validatedProduct = validateProduct(product);
    const result = await productRepository.save(validatedProduct);
    
    logger.info('Producto guardado exitosamente', { productId: result.id });
    return { success: true, data: result };
    
  } catch (error) {
    logger.error('Error al guardar producto', { error, product });
    
    if (error instanceof ValidationError) {
      return { success: false, error: 'Datos de producto inv√°lidos' };
    }
    
    return { success: false, error: 'Error interno del servidor' };
  }
}
```

### Funciones Async/Await
```javascript
// ‚úÖ Correcto - Uso consistente de async/await
async function loadProducts() {
  try {
    const products = await productRepository.findAll();
    const processedProducts = await Promise.all(
      products.map(product => processProduct(product))
    );
    return processedProducts;
  } catch (error) {
    throw new Error(`Error al cargar productos: ${error.message}`);
  }
}

// ‚ùå Incorrecto - Mezclar promises y async/await
async function loadProducts() {
  return productRepository.findAll()
    .then(products => {
      return products.map(product => processProduct(product));
    });
}
```

## üìö Documentaci√≥n de C√≥digo

### JSDoc para Funciones
```javascript
/**
 * Busca un producto por su c√≥digo de barras
 * @param {string} barcode - C√≥digo de barras del producto
 * @param {Object} options - Opciones de b√∫squeda
 * @param {boolean} options.includeInactive - Incluir productos inactivos
 * @param {string} options.source - Fuente de datos ('local', 'remote', 'both')
 * @returns {Promise<Object|null>} Producto encontrado o null si no existe
 * @throws {ValidationError} Cuando el c√≥digo de barras es inv√°lido
 * @example
 * const product = await findProductByBarcode('1234567890123', {
 *   includeInactive: false,
 *   source: 'both'
 * });
 */
async function findProductByBarcode(barcode, options = {}) {
  // Implementaci√≥n...
}
```

### JSDoc para Clases
```javascript
/**
 * Repositorio para operaciones CRUD de productos
 * Maneja tanto almacenamiento local (IndexedDB) como remoto (Supabase)
 * 
 * @class ProductRepository
 * @example
 * const repo = new ProductRepository();
 * const product = await repo.findById('123');
 */
class ProductRepository {
  /**
   * Crea una nueva instancia del repositorio de productos
   * @param {Object} config - Configuraci√≥n del repositorio
   * @param {boolean} config.enableSync - Habilitar sincronizaci√≥n autom√°tica
   */
  constructor(config = {}) {
    // Implementaci√≥n...
  }
}
```

## üéØ Principios de Dise√±o

### Single Responsibility Principle (SRP)
```javascript
// ‚úÖ Correcto - Cada clase tiene una responsabilidad
class ProductValidator {
  validate(product) { /* solo validaci√≥n */ }
}

class ProductRepository {
  save(product) { /* solo persistencia */ }
}

class ProductService {
  createProduct(data) {
    const product = this.validator.validate(data);
    return this.repository.save(product);
  }
}

// ‚ùå Incorrecto - Clase con m√∫ltiples responsabilidades
class ProductManager {
  validate(product) { /* validaci√≥n */ }
  save(product) { /* persistencia */ }
  sendEmail(product) { /* notificaci√≥n */ }
  generateReport(products) { /* reportes */ }
}
```

### Dependency Injection
```javascript
// ‚úÖ Correcto - Inyecci√≥n de dependencias
class ProductService {
  constructor(repository, validator, logger) {
    this.repository = repository;
    this.validator = validator;
    this.logger = logger;
  }
}

// Configuraci√≥n
const productService = new ProductService(
  new ProductRepository(),
  new ProductValidator(),
  new Logger()
);

// ‚ùå Incorrecto - Dependencias hardcodeadas
class ProductService {
  constructor() {
    this.repository = new ProductRepository(); // Acoplamiento fuerte
    this.validator = new ProductValidator();   // Dif√≠cil de testear
  }
}
```

## üß™ Patrones de Testing

### Nomenclatura de Tests
```javascript
// ‚úÖ Correcto - Descriptivo y en espa√±ol
describe('ProductValidator', () => {
  describe('validate', () => {
    test('debe validar un producto correcto', () => {
      // Test...
    });
    
    test('debe rechazar un producto sin c√≥digo', () => {
      // Test...
    });
    
    test('debe rechazar un producto con precio negativo', () => {
      // Test...
    });
  });
});

// ‚ùå Incorrecto - Poco descriptivo
describe('ProductValidator', () => {
  test('test1', () => {
    // Test...
  });
  
  test('validation test', () => {
    // Test...
  });
});
```

### Estructura de Tests
```javascript
// ‚úÖ Correcto - Patr√≥n Arrange-Act-Assert
test('debe calcular el precio total correctamente', () => {
  // Arrange
  const products = [
    { price: 100, quantity: 2 },
    { price: 50, quantity: 3 }
  ];
  const calculator = new PriceCalculator();
  
  // Act
  const total = calculator.calculateTotal(products);
  
  // Assert
  expect(total).toBe(350);
});
```

## üìã Checklist de Revisi√≥n de C√≥digo

### Antes de Commit
- [ ] El c√≥digo sigue las convenciones de nomenclatura
- [ ] Todas las funciones tienen documentaci√≥n JSDoc
- [ ] No hay console.log() en c√≥digo de producci√≥n
- [ ] Se manejan todos los errores posibles
- [ ] Las funciones tienen m√°ximo 50 l√≠neas
- [ ] La complejidad ciclom√°tica es menor a 10
- [ ] Se han a√±adido tests para nueva funcionalidad
- [ ] Los tests pasan exitosamente
- [ ] No hay c√≥digo duplicado
- [ ] Las dependencias est√°n bien definidas

### Revisi√≥n de Pull Request
- [ ] El c√≥digo es f√°cil de entender
- [ ] Los nombres de variables son descriptivos
- [ ] No hay l√≥gica de negocio en componentes de UI
- [ ] Se siguen los principios SOLID
- [ ] El rendimiento es aceptable
- [ ] La documentaci√≥n est√° actualizada
- [ ] No hay vulnerabilidades de seguridad

## üîß Herramientas de Calidad

### Scripts de Package.json
```json
{
  "scripts": {
    "lint": "eslint js/ --ext .js",
    "lint:fix": "eslint js/ --ext .js --fix",
    "format": "prettier --write js/**/*.js",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "analyze": "node tools/dependency-analyzer.js"
  }
}
```

### Pre-commit Hooks
```bash
#!/bin/sh
# .git/hooks/pre-commit

echo "üîç Ejecutando verificaciones antes del commit..."

# Ejecutar linter
npm run lint
if [ $? -ne 0 ]; then
  echo "‚ùå Error en linting. Corrige los errores antes de hacer commit."
  exit 1
fi

# Ejecutar tests
npm run test
if [ $? -ne 0 ]; then
  echo "‚ùå Tests fallaron. Corrige los errores antes de hacer commit."
  exit 1
fi

echo "‚úÖ Todas las verificaciones pasaron. Procediendo con el commit..."
```
