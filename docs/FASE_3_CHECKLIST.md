# üìã Checklist - Fase 3: Actualizaci√≥n de Archivos Legacy

**Estado:** üü° PENDIENTE  
**Fecha de Inicio:** Por definir  
**Objetivo:** Actualizar los 11 archivos legacy para usar bridges y eliminar duplicaci√≥n

---

## üéØ Objetivos de Fase 3

1. Actualizar archivos legacy para usar bridges en lugar de c√≥digo directo
2. Eliminar c√≥digo duplicado entre legacy y nueva arquitectura
3. Mantener funcionalidad 100% compatible durante migraci√≥n
4. Probar cada archivo actualizado individualmente
5. Completar migraci√≥n al 100%

---

## üìù Archivos a Actualizar (11 archivos)

### Prioridad Alta ‚ö†Ô∏è

#### ‚òê 1. auth.js
- **Dependencias:** databaseService, configuraciones
- **L√≠neas estimadas:** ~300
- **Complejidad:** Alta
- **Impacto:** Cr√≠tico - Usado por toda la app
- **Tareas:**
  - [ ] Revisar funciones exportadas
  - [ ] Identificar usos de db directos ‚Üí usar bridge
  - [ ] Actualizar imports a bridges
  - [ ] Probar login/logout
  - [ ] Verificar sincronizaci√≥n Supabase
  - [ ] Testing completo

#### ‚òê 2. scanner.js
- **Dependencias:** product-operations, db-operations
- **L√≠neas estimadas:** ~250
- **Complejidad:** Media-Alta
- **Impacto:** Alto - Funcionalidad principal
- **Tareas:**
  - [ ] Usar scanner-bridge en lugar de c√≥digo directo
  - [ ] Actualizar llamadas a DB ‚Üí usar bridge
  - [ ] Probar escaneo QR
  - [ ] Probar escaneo c√≥digo de barras
  - [ ] Verificar b√∫squeda de productos
  - [ ] Testing de rendimiento

#### ‚òê 3. product-operations.js
- **Dependencias:** db-operations, configuraciones
- **L√≠neas estimadas:** ~400
- **Complejidad:** Alta
- **Impacto:** Cr√≠tico - CRUD de productos
- **Tareas:**
  - [ ] Reemplazar todo por product-operations-bridge
  - [ ] Verificar que bridge tiene todas las funciones
  - [ ] Actualizar llamadas directas a DB
  - [ ] Probar agregar producto
  - [ ] Probar editar producto
  - [ ] Probar eliminar producto
  - [ ] Probar b√∫squeda
  - [ ] Testing de inventario

---

### Prioridad Media üî∂

#### ‚òê 4. tabla-productos.js
- **Dependencias:** product-operations, db-operations
- **L√≠neas estimadas:** ~200
- **Complejidad:** Media
- **Impacto:** Medio - UI de tabla
- **Tareas:**
  - [ ] Usar tabla-productos-bridge
  - [ ] Actualizar renderizado de tabla
  - [ ] Probar filtros
  - [ ] Probar ordenamiento
  - [ ] Probar paginaci√≥n
  - [ ] Testing de rendimiento con muchos productos

#### ‚òê 5. configuraciones.js
- **Dependencias:** db-operations
- **L√≠neas estimadas:** ~150
- **Complejidad:** Media
- **Impacto:** Medio - Configuraci√≥n de app
- **Tareas:**
  - [ ] Usar configuraciones-bridge
  - [ ] Actualizar guardado de configs
  - [ ] Probar cambio de ubicaci√≥n
  - [ ] Probar cambio de √°rea
  - [ ] Verificar persistencia
  - [ ] Testing de sincronizaci√≥n

#### ‚òê 6. registro-entradas-operations.js
- **Dependencias:** db-operations
- **L√≠neas estimadas:** ~200
- **Complejidad:** Media
- **Impacto:** Medio - Registro de entradas
- **Tareas:**
  - [ ] Usar db-operations-bridge
  - [ ] Actualizar funciones de entradas
  - [ ] Probar registro de entrada
  - [ ] Probar consulta de entradas
  - [ ] Verificar sincronizaci√≥n
  - [ ] Testing de historial

---

### Prioridad Baja üü¢

#### ‚òê 7. lotes-avanzado.js
- **Dependencias:** db-operations, product-operations
- **L√≠neas estimadas:** ~350
- **Complejidad:** Alta
- **Impacto:** Bajo-Medio - Funcionalidad avanzada
- **Tareas:**
  - [ ] Identificar funciones a migrar
  - [ ] Crear batch-bridge si es necesario
  - [ ] Actualizar gesti√≥n de lotes
  - [ ] Probar creaci√≥n de lotes
  - [ ] Probar edici√≥n de lotes
  - [ ] Testing de inventario por lotes

#### ‚òê 8. lotes-database.js
- **Dependencias:** db-operations
- **L√≠neas estimadas:** ~180
- **Complejidad:** Media
- **Impacto:** Bajo - DB de lotes
- **Tareas:**
  - [ ] Usar db-operations-bridge
  - [ ] Actualizar operaciones de DB
  - [ ] Probar guardado de lotes
  - [ ] Probar consulta de lotes
  - [ ] Verificar integridad de datos
  - [ ] Testing de migraciones

#### ‚òê 9. rep.js
- **Dependencias:** db-operations
- **L√≠neas estimadas:** ~250
- **Complejidad:** Media
- **Impacto:** Bajo - Reportes
- **Tareas:**
  - [ ] Usar fileOperationsService
  - [ ] Actualizar generaci√≥n de reportes
  - [ ] Probar reporte PDF
  - [ ] Probar reporte CSV
  - [ ] Verificar formato de datos
  - [ ] Testing de descarga

---

### Archivos a Deprecar üóëÔ∏è

#### ‚òê 10. db-operations.js
- **Estado:** Puede deprecarse completamente
- **Raz√≥n:** Todo migrado a db-operations-bridge.js
- **Acci√≥n:** Marcar como deprecated, mantener por compatibilidad temporal
- **Tareas:**
  - [ ] Agregar warnings de deprecaci√≥n
  - [ ] Verificar que nadie lo importe directamente
  - [ ] Redirigir todo a bridge
  - [ ] Documentar plan de eliminaci√≥n
  - [ ] Programar eliminaci√≥n para Fase 4

#### ‚òê 11. logs.js
- **Estado:** Puede deprecarse completamente
- **Raz√≥n:** Funcionalidad movida a BaseService
- **Acci√≥n:** Eliminar despu√©s de verificar que nadie lo usa
- **Tareas:**
  - [ ] Buscar todos los imports de logs.js
  - [ ] Verificar que todos usen BaseService
  - [ ] Eliminar archivo
  - [ ] Actualizar referencias en documentaci√≥n
  - [ ] Limpiar imports

---

## üìä Estimaciones

### Tiempo por Prioridad
- **Prioridad Alta:** 3 archivos √ó 2-3 horas = 6-9 horas
- **Prioridad Media:** 3 archivos √ó 1-2 horas = 3-6 horas
- **Prioridad Baja:** 3 archivos √ó 1-2 horas = 3-6 horas
- **Deprecaci√≥n:** 2 archivos √ó 0.5 horas = 1 hora

**Total estimado:** 13-22 horas

### Complejidad
- Alta: 3 archivos (auth.js, product-operations.js, lotes-avanzado.js)
- Media: 6 archivos
- Baja: 2 archivos (deprecaci√≥n)

---

## üß™ Testing por Archivo

### Checklist de Testing Individual

Para cada archivo actualizado:

- [ ] ‚úÖ No hay errores en consola
- [ ] ‚úÖ Imports correctos desde bridges
- [ ] ‚úÖ Funcionalidad b√°sica funciona
- [ ] ‚úÖ Sincronizaci√≥n con Supabase funciona
- [ ] ‚úÖ Modo offline funciona
- [ ] ‚úÖ No hay regresiones
- [ ] ‚úÖ Performance aceptable
- [ ] ‚úÖ Documentaci√≥n actualizada

---

## üìà M√©tricas de √âxito

### Fase 3 se considera completa cuando:

1. ‚úÖ Los 11 archivos est√°n actualizados
2. ‚úÖ Todos los tests pasan
3. ‚úÖ No hay c√≥digo duplicado entre legacy y nuevo
4. ‚úÖ La app funciona al 100% con bridges
5. ‚úÖ Documentaci√≥n actualizada
6. ‚úÖ Migraci√≥n al 100% completada

### KPIs
- **Cobertura de migraci√≥n:** 100%
- **Tests pasando:** 100%
- **C√≥digo duplicado:** 0%
- **Archivos legacy directos:** 0 (solo bridges)
- **Performance:** Sin degradaci√≥n

---

## üöÄ Plan de Ejecuci√≥n

### Semana 1: Prioridad Alta
- D√≠as 1-2: auth.js
- D√≠as 3-4: scanner.js
- D√≠as 5: product-operations.js

### Semana 2: Prioridad Media + Baja
- D√≠as 1-2: tabla-productos.js + configuraciones.js
- D√≠a 3: registro-entradas-operations.js
- D√≠as 4-5: lotes-avanzado.js + lotes-database.js + rep.js

### Semana 3: Deprecaci√≥n y Testing
- D√≠a 1: db-operations.js deprecaci√≥n
- D√≠a 2: logs.js eliminaci√≥n
- D√≠as 3-5: Testing integral y ajustes finales

---

## ‚ö†Ô∏è Riesgos y Mitigaciones

### Riesgos Identificados

1. **Funcionalidad rota durante migraci√≥n**
   - Mitigaci√≥n: Migrar archivo por archivo, testing exhaustivo
   
2. **C√≥digo legacy que importa directamente**
   - Mitigaci√≥n: B√∫squeda exhaustiva de imports antes de deprecar
   
3. **Regresiones en funcionalidad cr√≠tica**
   - Mitigaci√≥n: Suite de tests automatizados
   
4. **Performance degradada**
   - Mitigaci√≥n: Benchmarks antes y despu√©s

---

## üìö Recursos

### Documentaci√≥n de Referencia
- [INTEGRACION_LEGACY_COMPLETADA.md](./INTEGRACION_LEGACY_COMPLETADA.md)
- [ARCHITECTURE.md](./ARCHITECTURE.md)
- [REPOSITORIES_GUIDE.md](./REPOSITORIES_GUIDE.md)

### Herramientas
- Test de integraci√≥n: `test-integraci√≥n-completa.html`
- Service Worker v3
- Consola de desarrollador

---

## ‚úÖ Cuando Fase 3 Est√© Completa

Habremos logrado:

1. ‚úÖ **Migraci√≥n 100% completa** a nueva arquitectura
2. ‚úÖ **C√≥digo legacy eliminado** o usando bridges
3. ‚úÖ **Sin duplicaci√≥n** de l√≥gica
4. ‚úÖ **App totalmente funcional** con nueva estructura
5. ‚úÖ **Base s√≥lida** para Fase 4 (optimizaciones)

---

**Pr√≥xima Fase (Fase 4):** Optimizaciones, mejoras de performance, y caracter√≠sticas nuevas

---

**√öltima actualizaci√≥n:** 3 de octubre de 2025  
**Responsable:** Angel Aramiz
